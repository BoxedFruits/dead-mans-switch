{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\samba\\\\Desktop\\\\ETH Projects\\\\dead-mans-switch\\\\dead-mans-switch-front-end\\\\src\\\\components\\\\contractInteraction.jsx\";\nimport { Modal, Button, Space, Input, Spin } from 'antd';\nimport React from 'react';\nimport DeadMansContract from '../utils/DeadMansContract.abi.json';\nimport { ethers } from \"ethers\";\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst antIcon = /*#__PURE__*/_jsxDEV(LoadingOutlined, {\n  style: {\n    fontSize: 92,\n    width: 100\n  },\n  spin: true\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 7,\n  columnNumber: 17\n}, this);\n\nclass ContractInteraction extends React.Component {\n  constructor() {\n    super();\n\n    this.initContract = () => {\n      const provider = new ethers.providers.Web3Provider(ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(this.props.address, DeadMansContract.abi, signer);\n      return contract;\n    };\n\n    this.isActive = async () => {\n      try {\n        const tx = await this.initContract().isActive();\n        this.setState({\n          pendingTx: false,\n          showIsActiveText: true,\n          active: tx\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.tick = async () => {\n      try {\n        const tx = await this.initContract().tick();\n        this.setState({\n          pendingTx: true\n        });\n        await tx.wait();\n        this.setState({\n          pendingTx: false\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.getNextTimeStamp = async () => {\n      try {\n        const tx = await this.initContract().getNextTimeStamp();\n        this.setState({\n          pendingTx: false,\n          showNextTimeStamp: true,\n          nextTimeStamp: Date(parseInt(BigInt(tx))).toString()\n        });\n      } catch (e) {}\n    };\n\n    this.setUrl = async () => {\n      try {\n        const newUrl = document.getElementById(\"setUrl\").value;\n        const tx = await this.initContract().setUrl(newUrl);\n        this.setState({\n          pendingTx: true\n        });\n        await tx.wait();\n        this.setState({\n          pendingTx: false\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.getUrl = async () => {\n      try {\n        const tx = await this.initContract().getUrl();\n        this.setState({\n          pendingTx: true\n        });\n        await tx.wait();\n        this.setState({\n          pendingTx: false,\n          showGetUrlText: true,\n          url: res\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.getDecryptionKey = async () => {\n      try {\n        const tx = await this.initContract().getDecryptionKey();\n      } catch (e) {\n        console.log(e[\"message\"]);\n      } // Will error if  block timestamp < nextTimestamp ***\n\n    };\n\n    this.renounceOwnershipModal = () => {\n      this.setState({\n        isModalRenounceVisible: true\n      });\n    };\n\n    this.renounceOwnership = async () => {\n      const tx = await this.initContract().renounceOwnership();\n      await tx.wait();\n      this.handleRenounceCancel();\n    };\n\n    this.handleRenounceCancel = () => {\n      this.setState({\n        isModalRenounceVisible: false\n      });\n    };\n\n    this.defuse = async () => {\n      const tx = await this.initContract().defuse();\n      await tx.wait();\n      this.handleDefuseCancel();\n    };\n\n    this.defuseModal = () => {\n      this.setState({\n        isModalDefuseVisible: true\n      });\n    };\n\n    this.handleDefuseCancel = () => {\n      this.setState({\n        isModalDefuseVisible: false\n      });\n    };\n\n    this.state = {\n      active: false,\n      url: \"\",\n      decryptionKey: \"\",\n      nextTimeStamp: \"\",\n      pendingTx: false,\n      showIsActiveText: false,\n      showTickText: false,\n      showRenounceText: false,\n      showGetDecryptionText: false,\n      showDefuseText: false,\n      showGetUrlText: false,\n      showSetUrlText: false,\n      showNextTimeStamp: false,\n      isModalRenounceVisible: false,\n      isModalDefuseVisible: false\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Contract Address: \", this.props.address]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this), this.state.pendingTx ? /*#__PURE__*/_jsxDEV(Spin, {\n        indicator: antIcon,\n        style: {\n          width: \"100%\",\n          marginTop: \"4rem\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 41\n      }, this) : /*#__PURE__*/_jsxDEV(Space, {\n        direction: \"vertical\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.isActive,\n          children: \"Check Heartbeat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 25\n        }, this), this.state.showIsActiveText && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"The switch is \", this.state.active ? \"still \" : \"not \", \" being monitored.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 57\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.getNextTimeStamp,\n          children: \"Get Next Time Stamp\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 25\n        }, this), this.state.showNextTimeStamp && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.nextTimeStamp\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 58\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.getUrl,\n          children: \"Get URL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }, this), this.state.showGetUrlText && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.url === \"\" ? \"There was no URL set or was left blank\" : this.state.url\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 55\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.tick,\n          children: \"Add Time\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.defuse,\n          children: \"Defuse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.renounceOwnershipModal,\n          children: \"Renounce Ownership\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.setUrl,\n          children: \"Set Url\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          size: \"large\",\n          id: \"setUrl\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.getDecryptionKey,\n          children: \"Reveal Decryption Key\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 25\n        }, this), this.state.showGetDecryptionText && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.decryptionKey === \"\" ? \"\" : this.state.url\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 62\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        id: \"renounce\",\n        title: \"Are you sure?\",\n        visible: this.state.isModalRenounceVisible,\n        footer: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleRenounceCancel,\n          children: \"Cancel\"\n        }, \"back\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.renounceOwnership,\n          children: \"Renounce Ownership\"\n        }, \"submit\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 25\n        }, this)],\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Renouncing the ownership of the Dead Man's Switch means that if not defused, there is no stopping the switch from activating.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"This action is is irreversible.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        id: \"defuse\",\n        title: \"Are you sure?\",\n        visible: this.state.isModalDefuseVisible,\n        footer: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.defuse,\n          children: \"Cancel\"\n        }, \"back\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleDefuseCancel,\n          children: \"Defuse\"\n        }, \"submit\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 25\n        }, this)],\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Defusing the Dead Man's Switch means that the danger has passed and the use of the switch is no longer needed. The decryption key will not be revealed and you will no longer need to check on the switch.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"This action is is irreversible.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default ContractInteraction;","map":{"version":3,"sources":["C:/Users/samba/Desktop/ETH Projects/dead-mans-switch/dead-mans-switch-front-end/src/components/contractInteraction.jsx"],"names":["Modal","Button","Space","Input","Spin","React","DeadMansContract","ethers","LoadingOutlined","antIcon","fontSize","width","ContractInteraction","Component","constructor","initContract","provider","providers","Web3Provider","ethereum","signer","getSigner","contract","Contract","props","address","abi","isActive","tx","setState","pendingTx","showIsActiveText","active","e","console","log","tick","wait","getNextTimeStamp","showNextTimeStamp","nextTimeStamp","Date","parseInt","BigInt","toString","setUrl","newUrl","document","getElementById","value","getUrl","showGetUrlText","url","res","getDecryptionKey","renounceOwnershipModal","isModalRenounceVisible","renounceOwnership","handleRenounceCancel","defuse","handleDefuseCancel","defuseModal","isModalDefuseVisible","state","decryptionKey","showTickText","showRenounceText","showGetDecryptionText","showDefuseText","showSetUrlText","render","marginTop"],"mappings":"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","sourcesContent":["import { Modal, Button, Space, Input, Spin } from 'antd';\r\nimport React from 'react';\r\nimport DeadMansContract from '../utils/DeadMansContract.abi.json';\r\nimport { ethers } from \"ethers\";\r\nimport { LoadingOutlined } from '@ant-design/icons';\r\n\r\nconst antIcon = <LoadingOutlined style={{ fontSize: 92, width: 100 }} spin />;\r\n\r\nclass ContractInteraction extends React.Component {\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            active: false,\r\n            url: \"\",\r\n            decryptionKey: \"\",\r\n            nextTimeStamp: \"\",\r\n            pendingTx: false,\r\n            showIsActiveText: false,\r\n            showTickText: false,\r\n            showRenounceText: false,\r\n            showGetDecryptionText: false,\r\n            showDefuseText: false,\r\n            showGetUrlText: false,\r\n            showSetUrlText: false,\r\n            showNextTimeStamp: false,\r\n            isModalRenounceVisible: false,\r\n            isModalDefuseVisible: false\r\n        };\r\n    }\r\n\r\n    initContract = () => {\r\n        const provider = new ethers.providers.Web3Provider(ethereum);\r\n        const signer = provider.getSigner();\r\n        const contract = new ethers.Contract(this.props.address, DeadMansContract.abi, signer);\r\n        return contract;\r\n    }\r\n\r\n    isActive = async () => {\r\n        try {\r\n            const tx = await this.initContract().isActive();\r\n            this.setState({ pendingTx: false, showIsActiveText: true, active: tx });\r\n        } catch (e) {\r\n            console.log(e)\r\n        }\r\n    };\r\n\r\n    tick = async () => {\r\n        try {\r\n            const tx = await this.initContract().tick();\r\n\r\n            this.setState({ pendingTx: true });\r\n\r\n            await tx.wait();\r\n            this.setState({ pendingTx: false });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    };\r\n\r\n    getNextTimeStamp = async () => {\r\n        try {\r\n            const tx = await this.initContract().getNextTimeStamp();\r\n            this.setState({ pendingTx: false, showNextTimeStamp: true, nextTimeStamp: Date(parseInt(BigInt(tx))).toString() });\r\n        } catch (e) {\r\n\r\n        }\r\n    }\r\n\r\n    setUrl = async () => {\r\n        try {\r\n            const newUrl = document.getElementById(\"setUrl\").value;\r\n            const tx = await this.initContract().setUrl(newUrl);\r\n\r\n            this.setState({ pendingTx: true });\r\n            await tx.wait();\r\n            this.setState({ pendingTx: false });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    };\r\n\r\n    getUrl = async () => {\r\n        try {\r\n            const tx = await this.initContract().getUrl();\r\n            this.setState({ pendingTx: true });\r\n\r\n            await tx.wait();\r\n            this.setState({ pendingTx: false, showGetUrlText: true, url: res });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    };\r\n\r\n    getDecryptionKey = async () => {\r\n        try {\r\n        const tx = await this.initContract().getDecryptionKey();\r\n        } catch (e) {\r\n            console.log(e[\"message\"]);\r\n        }\r\n        // Will error if  block timestamp < nextTimestamp ***\r\n    };\r\n\r\n\r\n\r\n    renounceOwnershipModal = () => {\r\n        this.setState({ isModalRenounceVisible: true });\r\n    }\r\n\r\n    renounceOwnership = async () => {\r\n        const tx = await this.initContract().renounceOwnership();\r\n\r\n        await tx.wait();\r\n        this.handleRenounceCancel();\r\n    };\r\n\r\n    handleRenounceCancel = () => {\r\n        this.setState({ isModalRenounceVisible: false });\r\n    };\r\n\r\n    defuse = async () => {\r\n        const tx = await this.initContract().defuse();\r\n\r\n        await tx.wait();\r\n        this.handleDefuseCancel();\r\n    };\r\n\r\n    defuseModal = () => {\r\n        this.setState({ isModalDefuseVisible: true });\r\n    }\r\n\r\n    handleDefuseCancel = () => {\r\n        this.setState({ isModalDefuseVisible: false });\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                {/* Give more emphasis to this */}\r\n                <div>Contract Address: {this.props.address}</div>\r\n                {this.state.pendingTx ? <Spin indicator={antIcon} style={{ width: \"100%\", marginTop: \"4rem\" }} /> : (\r\n                    <Space direction=\"vertical\">\r\n\r\n                        {/* Take these buttons out and put them at the top of the page instead. It is important information */}\r\n                        <Button onClick={this.isActive}>Check Heartbeat</Button>\r\n                        {this.state.showIsActiveText && <p>The switch is {this.state.active ? \"still \" : \"not \"} being monitored.</p>}\r\n                        <Button onClick={this.getNextTimeStamp}>Get Next Time Stamp</Button>\r\n                        {this.state.showNextTimeStamp && <p>{this.state.nextTimeStamp}</p>}\r\n                        <Button onClick={this.getUrl}>Get URL</Button>\r\n                        {this.state.showGetUrlText && <p>{this.state.url === \"\" ? \"There was no URL set or was left blank\" : this.state.url}</p>}\r\n\r\n                        <Button onClick={this.tick}>Add Time</Button>\r\n                        <Button onClick={this.defuse}>Defuse</Button>\r\n                        <Button onClick={this.renounceOwnershipModal}>Renounce Ownership</Button>\r\n\r\n                        <Button onClick={this.setUrl}>Set Url</Button>\r\n                        <Input size=\"large\" id=\"setUrl\" />\r\n\r\n                        <Button onClick={this.getDecryptionKey}>Reveal Decryption Key</Button>\r\n                        {this.state.showGetDecryptionText && <p>{this.state.decryptionKey === \"\" ? \"\" : this.state.url}</p>}\r\n                    </Space>\r\n                )}\r\n\r\n                <Modal id=\"renounce\" title=\"Are you sure?\" visible={this.state.isModalRenounceVisible}\r\n                    footer={[\r\n                        <Button key=\"back\" onClick={this.handleRenounceCancel}>Cancel</Button>,\r\n                        <Button key=\"submit\" onClick={this.renounceOwnership}>Renounce Ownership</Button>\r\n                    ]}>\r\n                    <p>Renouncing the ownership of the Dead Man's Switch means that if not defused, there is no stopping the switch from activating.</p>\r\n                    <p>This action is is irreversible.</p>\r\n                </Modal>\r\n\r\n                <Modal id=\"defuse\" title=\"Are you sure?\" visible={this.state.isModalDefuseVisible}\r\n                    footer={[\r\n                        <Button key=\"back\" onClick={this.defuse} >Cancel</Button>,\r\n                        <Button key=\"submit\" onClick={this.handleDefuseCancel}>Defuse</Button>\r\n                    ]}>\r\n                    <p>Defusing the Dead Man's Switch means that the danger has passed and the use of the switch is no longer needed. The decryption key \r\n                        will not be revealed and you will no longer need to check on the switch.</p>\r\n                    <p>This action is is irreversible.</p>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    };\r\n}\r\n\r\nexport default ContractInteraction;"]},"metadata":{},"sourceType":"module"}